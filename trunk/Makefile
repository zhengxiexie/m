###########################################################################
# Automatically generated by comake (1.0.1)  							  #
###########################################################################

#################设计系统参数#######################################
WORKROOT	?=	/home/work/
IDLCC	:=	$(WORKROOT)/public/idlcompiler/output/bin/mcy
RPCCC :=  $(WORKROOT)/public/ubrpc/output/bin/ubrpcgen
CC	:=	gcc
CXX	:=	g++
LEX	:=	flex
YACC	:= yacc
CFLAGS	:=	-pipe -Wall -W -g -fPIC
CXXFLAGS	:=	-pipe -Wall -W -g -fPIC
LEXFLAGS	:=	
YACCFLAGS	:=	
IDLFLAGS	:=  --bean
LINKFLAGS	:=  -rdynamic
LINK	:=	g++
AR	:=	ar cqs
RANLIB	:=	
COMAKE	:=	comake


###############baidu lib 的32位 64位支持#################
HARDWARE_PLATFORM := $(shell uname -m)
ifeq ($(HARDWARE_PLATFORM),x86_64)
	lib2=lib2-64
	third=third-64
else
	lib2=lib2
	third=third
endif
##########################################

# 编译参数
#DEP_INCPATH =  -I$(WORKROOT)/public/spreg/output//include/ -I$(WORKROOT)/public/mcpack/output//include/ -I$(WORKROOT)/public/comlog-plugin/output//include/ -I$(WORKROOT)/public/connectpool/output// -I$(WORKROOT)/public/bslext/output//include/ -I$(WORKROOT)/$(lib2)/dict//include/ -I$(WORKROOT)/$(third)/stlport// -I$(WORKROOT)/public/ubrpc/output//include/ -I$(WORKROOT)/public/gm/galileo/output//include/ -I$(WORKROOT)/com/idlcompiler/output// -I$(WORKROOT)/public/uconv/output//include/ -I$(WORKROOT)/public/nshead/output//include/ -I$(WORKROOT)/public/ub/output//include/ -I$(WORKROOT)/$(third)/pcre//include/ -I$(WORKROOT)/public/myclient/output//include/ -I$(WORKROOT)/public/configure/output//include/ -I$(WORKROOT)/$(lib2)/ullib//include/ -I$(WORKROOT)/public/odict/output//include/ -I$(WORKROOT)/public/idlcompiler/output//include/ -I$(WORKROOT)/$(third)/boost// -I$(WORKROOT)/$(lib2)/bsl//include/ -I/usr/local/mysql/include/mysql/  -I$(WORKROOT)/public/gm/zcacheapi/apiplus -I$(WORKROOT)/public/gm/zcacheapi/zcacheapi -I$(WORKROOT)/public/gm/zcacheapi/output/include/ -I$(WORKROOT)/public/gm/zcacheapi/lib/ -I$(WORKROOT)/public/kylin//kylin/ -I$(WORKROOT)/public/kylin/share/ -I$(WORKROOT)/public/ns/mynet/ -I/home/liyong/include/mysql/ -I/home/liyong/include/hiredis
#DEP_LDFLAGS =  -L./ -L$(WORKROOT)/public/myclient/output//lib/ -L$(WORKROOT)/public/gm/galileo/output//lib/ -L$(WORKROOT)/public/idlcompiler/output//lib/ -L$(WORKROOT)/public/connectpool/output// -L$(WORKROOT)/$(third)/boost// -L$(WORKROOT)/$(third)/stlport// -L$(WORKROOT)/public/comlog-plugin/output//lib/ -L$(WORKROOT)/public/nshead/output// -L$(WORKROOT)/com/idlcompiler/output// -L$(WORKROOT)/public/ubrpc/output//lib/ -L$(WORKROOT)/public/bslext/output//lib/ -L$(WORKROOT)/$(lib2)/bsl//lib/ -L$(WORKROOT)/$(lib2)/ullib//lib/ -L$(WORKROOT)/public/mcpack/output//lib/ -L$(WORKROOT)/$(lib2)/dict//lib/ -L$(WORKROOT)/public/configure/output//lib/ -L$(WORKROOT)/public/odict/output// -L$(WORKROOT)/$(third)/pcre//lib/ -L$(WORKROOT)/public/uconv/output// -L$(WORKROOT)/public/ub/output//lib/ -L$(WORKROOT)/public/spreg/output//lib/ -L/usr/local/mysql/lib/mysql/ -L$(WORKROOT)/public/gm/zcacheapi/apiplus  -L$(WORKROOT)/public/gm/zcacheapi/zcacheapi -L$(WORKROOT)/public/gm/zcacheapi/lib -L$(WORKROOT)/public/gm/zcacheapi/output/lib/  -L$(WORKROOT)/public/ns/mynet/ -L$(WORKROOT)/public/kylin/kylin/ -L$(WORKROOT)/public/kylin/share/ -L/home/liyong/lib/mysql -L/home/liyong/lib/hiredis
DEP_LDLIBS = -lservlet -lclient -lmyclient -lub -lgalileo -lzookeeper_mt -lcomlog -ldfsappender -lbsl_bml -lbsl_var_serializer -lbsl_var_scripting -lbsl_vs -lbsl_containers_utils -lbsl_var_vscript -lbslext -lconnectpool -lconfig -lmcpack_idl -lodict -luconv -lmcpack -lspreg -lnshead -luldict -lullib -lpcre -lpcrecpp -lpcreposix -lbsl -lmysqlclient -lz libbson.a libmongoc.a -lhiredis -ljson_linux-gcc-3.4.5_libmt
DEP_INCPATH =  -I$(WORKROOT)/public/spreg/output//include/ -I$(WORKROOT)/public/mcpack/output//include/ -I$(WORKROOT)/public/comlog-plugin/output//include/ -I$(WORKROOT)/public/connectpool/output// -I$(WORKROOT)/public/bslext/output//include/ -I$(WORKROOT)/public/ubrpc/output//include/ -I$(WORKROOT)/public/gm/galileo/output//include/ -I$(WORKROOT)/public/uconv/output//include/ -I$(WORKROOT)/public/nshead/output//include/ -I$(WORKROOT)/public/ub/output//include/ -I$(WORKROOT)/public/myclient/output//include/ -I$(WORKROOT)/public/configure/output//include/ -I$(WORKROOT)/public/odict/output//include/ -I$(WORKROOT)/public/idlcompiler/output//include/ -I$(WORKROOT)/public/ub/$(lib2)/ullib/include/ -I$(WORKROOT)//public/ub/$(third)/boost// -I$(WORKROOT)/public/ub/$(lib2)/bsl/include/ -I/home/work/server/mysql/include/mysql/   -I$(WORKROOT)/public/ub//$(third)/pcre//include/ -I./include -I$(WORKROOT)/server/redis-stable/deps/hiredis -I$(WORKROOT)/server/redis-stable/deps/hiredis/adapters
DEP_LDFLAGS =  -L$(WORKROOT)/public/gm/galileo/output//lib/ -L$(WORKROOT)/public/idlcompiler/output//lib/ -L$(WORKROOT)/public/connectpool/output// -L$(WORKROOT)/public/comlog-plugin/output//lib/ -L$(WORKROOT)/public/nshead/output// -L$(WORKROOT)/public/ubrpc/output//lib/ -L$(WORKROOT)/public/bslext/output//lib/  -L$(WORKROOT)/public/ub/$(lib2)/bsl//lib/ -L$(WORKROOT)/public/ub/$(lib2)/ullib//lib/  -L$(WORKROOT)/public/ub/$(lib2)/dict//lib/ -L$(WORKROOT)/public/mcpack/output//lib/ -L$(WORKROOT)/public/configure/output//lib/ -L$(WORKROOT)/public/odict/output// -L$(WORKROOT)/public/uconv/output// -L$(WORKROOT)/public/ub/output//lib/ -L$(WORKROOT)/public/spreg/output//lib/   -L$(WORKROOT)/public/ub/$(third)/pcre/lib/ -L$(WORKROOT)/server/lib/ -L$(WORKROOT)/public/myclient/output//lib/  
#DEP_LDLIBS = -lservlet -lclient -lmyclient -lub -lgalileo -lzookeeper_mt -lcomlog -ldfsappender -lbsl_bml -lbsl_var_serializer -lbsl_var_scripting -lbsl_vs -lbsl_containers_utils -lbsl_var_vscript -lbslext -lconnectpool -lconfig -lmcpack_idl -lodict -luconv -lmcpack -lspreg -lnshead -luldict -lullib -lpcre -lpcrecpp -lpcreposix -lbsl -lmysqlclient -lhiredis -lcurl libbson.a libmongoc.a   ....  -lzcacheapiplus -lzcacheapi -lkylin  -lshare -lmynet
INCPATH =  -I. -I.
#MAKDEP = Makefile.dep


#start target
first : all

############# 默认推到公式
.SUFFIXES: .c .cpp .cc .cxx .C .idl .des
.PRECIOUS: %.cpp

.cpp.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.cc.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.cxx.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.C.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.c.o:
	$(CC) -c -o $@ $<  $(CFLAGS) $(CPPFLAGS) $(INCPATH)

.idl.cpp:
	$(IDLCC) --ns=$(*F) -o $* $< $(CPPFLAGS) $(INCPATH) $(IDLFLAGS)

#############
###cpp 支持
%info : %
	ccp $<
#############


#__$MAKEFILE_RULES$__



###############编译目标
all :  target output 
.PHONY : all clean test output comake src conf 

target : mcp 
#target : rpcidl mcp 
#target : 
#__$target_CMDLINE$__

rpcidl : mcp.idl chess_hall_props.idl
	 $(RPCCC) $(IDLFLAGS) mcp.idl
	 $(IDLCC) --ubrpc $(IDLFLAGS)  mcp.idl
	 $(RPCCC) $(IDLFLAGS) chess_hall_props.idl
	 $(IDLCC) --ubrpc $(IDLFLAGS)  chess_hall_props.idl

clean_rpcidl : 
	rm -f mcp.idl.* chess_hall_props.idl.*


test : 


comake :
	-make clean
	-comake 

#-include $(MAKDEP)
#-include $(MAKDEP)

#----------------build target : mcp--------------------

mcp : CC := gcc
mcp : CXX := g++
mcp : CXXFLAGS := -pipe -Wall -W -g -fPIC -DMONGO_HAVE_UNISTD
mcp : CPPFLAGS := 
mcp : IDLFLAGS := 
mcp : CFLAGS := -pipe -Wall -W -g -fPIC 
mcp : INCPATH :=  -I. -I. $(DEP_INCPATH)
mcp : LDLIBS := -lcrypto -lm -lpthread $(DEP_LDLIBS)
mcp : LDFLAGS :=  $(DEP_LDFLAGS)
mcp : LINKFLAGS := -rdynamic

mcp_SOURCES := $(wildcard comake_autogen.cpp main.cpp mcp.idl*.cpp chess_hall_props.idl*.cpp mcpsvr.cpp \
PHDicTree.cpp mcpsvr_hm.cpp UADicTree.cpp mcpsvr_phone_headword.cpp tools.cpp mcpsvr_search_phone.cpp \
mcpsvr_get_carriers_from_ip.cpp mcpsvr_get_phone_from_maker.cpp mcpsvr_mongo_contentapi.cpp mcpsvr_ly.cpp \
mcpsvr_get_mcp_stat.cpp mcpsvr_content_common.cpp mongo_connpool.cpp duokoo_mysql.cpp mcp_session.cpp \
content_common.cpp content_list.cpp content_class.cpp content_rank.cpp content_label.cpp content_column.cpp \
content_info.cpp software_info.cpp android_theme.cpp content_topic.cpp content_type.cpp mcpsvr_content.cpp \
ip_gateway.cpp mcpsvr_adapt.cpp ios_content.cpp content_cp.cpp content_probably_like.cpp game_info_content.cpp \
game_list.cpp game_score.cpp appinfo_content.cpp game_star.cpp redis_connpool.cpp game_package_version.cpp \
online_game.cpp mcpsvr_grab.cpp duokoo_tools.cpp grab.cpp rating.cpp mixed_topic_music.cpp duoku_paradise.cpp \
duoku_paradise_game_list.cpp content_calender.cpp get_star.cpp \
refactory/module/abstract_mcp_content.cpp \
refactory/module/mcp_game_content.cpp \
refactory/module/mb_music_content.cpp \
refactory/module/mcp_content_data.cpp \
refactory/module/mcp_content_news.cpp \
refactory/module/mcp_content_common_info.cpp \
refactory/module/mcp_netgame_activity.cpp \
refactory/module/mcp_content_diy_column.cpp \
refactory/module/mcp_diff_update_info.cpp \
refactory/module/mcp_content_championship.cpp \
refactory/module/mcp_content_appinfo_data.cpp \
refactory/module/pt_game_QandA.cpp \
refactory/module/pt_game_user_QA_list.cpp \
refactory/module/mcp_content_qp_activity.cpp \
refactory/module/mcp_content_qp_activity_award.cpp \
refactory/module/mcp_content_qp_activity_person.cpp \
refactory/module/mcp_content_person_award.cpp \
refactory/decorator/abstract_decorator.cpp \
refactory/decorator/single_decorator/abstract_single_decorator.cpp \
refactory/decorator/single_decorator/is_decorator.cpp \
refactory/decorator/single_decorator/like_decorator.cpp \
refactory/decorator/single_decorator/or_decorator.cpp \
refactory/decorator/single_decorator/orderby_decorator.cpp \
refactory/decorator/single_decorator/weight_decorator.cpp \
refactory/decorator/single_decorator/groupby_decorator.cpp \
refactory/decorator/single_decorator/bigger_decorator.cpp \
refactory/decorator/single_decorator/smaller_decorator.cpp \
refactory/decorator/single_decorator/not_equal_decorator.cpp \
refactory/decorator/compound_decorator/abstract_compound_decorator.cpp \
refactory/decorator/compound_decorator/decorator_for_test.cpp \
refactory/binder/abstract_binder.cpp \
refactory/binder/compound_binder.cpp \
refactory/mysql_module/extend_column.cpp \
refactory/mysql_module/mysql_general_module.cpp \
refactory/output_type/game_basic_download_info.cpp \
refactory/output_type/once_consume_goods.cpp \
refactory/output_type/game_info_t.cpp \
refactory/output_type/grab_info_t.cpp \
refactory/output_type/diff_detail_data_t.cpp \
refactory/output_type/pt_game_basic_info_t.cpp \
refactory/music_output_type/mobile_music_info_t.cpp \
refactory/output_type/user_grab_number_t.cpp \
refactory/output_type/game_news_info_t.cpp \
refactory/output_type/column_info_t.cpp \
refactory/output_type/netgame_activity_info_t.cpp \
refactory/output_type/game_update_download_info.cpp \
refactory/output_type/championship_basic_download_info.cpp \
refactory/output_type/game_basic_info.cpp \
refactory/output_type/download_detail_data_t.cpp \
refactory/output_type/game_content_download_info_t.cpp \
refactory/output_type/game_news_entire_info_t.cpp \
refactory/output_type/vir_currency_info.cpp \
refactory/input_type/input_extractor.cpp \
refactory/input_type/json_extractor.cpp \
refactory/factory/mutex_shell.cpp \
refactory/factory/two_binded_factory.cpp \
refactory/factory/compound_binded_factory.cpp \
refactory/redis_module/redis_module.cpp \
refactory/redis_module/duoku_user_download.cpp \
refactory/redis_module/device_download.cpp \
refactory/redis_module/duoku_user_guide.cpp \
refactory/redis_module/duoku_user_favorite.cpp \
refactory/rpc/notice_rpc.cpp \
refactory/client/middle_client.cpp \
refactory/client/community_client.cpp \
refactory/adapt_old.cpp \
refactory/common.cpp \
refactory/common_simple_buf.cpp \
refactory/mcpsvr_refactory.cpp \
refactory/mcpsvr_new.cpp \
refactory/mobile_music.cpp \
refactory/gamedev_svr.cpp \
refactory/mcpsvr_baiduAppInfo.cpp) 
#refactory/test/big_tester.cpp \
#refactory/test/littel_tester.cpp)
#mcp_HEADERS := $(wildcard *.h)
#mcp_SOURCES := $(wildcard comake_autogen.cpp *.cpp)
mcp_HEADERS := *.h
mcp_IDLSRC := $(wildcard )
mcp_IDLSRCCPP := $(patsubst %.idl,%.cpp, $(mcp_IDLSRC))
mcp_IDLSRCH := $(patsubst %.idl,%.h, $(mcp_IDLSRC))
mcp_CONFDES := $(wildcard __$CONFDES$_VALUE$__ mcp.des)
mcp_CONFRANGE := $(patsubst %.des,%.range, $(mcp_CONFDES))
mcp_OBJS := $(mcp_IDLSRC:.idl=.o)
mcp_OBJS += $(mcp_SOURCES:.c=.o)
mcp_OBJS := $(mcp_OBJS:.cc=.o)
mcp_OBJS := $(mcp_OBJS:.cpp=.o)
mcp_OBJS := $(mcp_OBJS:.cxx=.o)
mcp_OBJS := $(mcp_OBJS:.C=.o)
mcp_OBJS := $(mcp_OBJS:.idl=.o)
mcp_OBJS := $(mcp_OBJS:.yacc=.o)
mcp_OBJS := $(mcp_OBJS:.lex=.o)
mcp : $(mcp_OBJS) 
	@echo "force_clean"
	$(foreach n, $(wildcard ), $(if ifeq($(suffix $(n)), .c), $(CC) -c -o $(basename $(n)).o $(n) $(CXXFLAGS) $(CPPFLAGS) $(INCPATH);  , $(CXX) -c -o $(basename $(n)).o $(n) $(CXXFLAGS) $(CPPFLAGS) $(INCPATH); ))
	@`for x in $(mcp_CONFDES);do cpp -C -o mcp.range $$x $(CPPFLAGS) $(INCPATH);mkdir -p conf;cp mcp.range conf/; done`
	$(LINK) $^ -o $@ -Xlinker "-(" $(LDFLAGS) $(LDLIBS) $(LINKFLAGS) -Xlinker "-)"


define mcp_output
	mkdir -p output
	mkdir -p output/bin
	cp -rf mcp output/bin
	`if [ -e "conf" ];then cp -rf conf output/ ;fi`

endef
	

define mcp_clean
	-rm -rf $(mcp_OBJS) $(mcp_IDLSRCCPP) $(mcp_IDLSRCH) mcp.range conf/mcp.range
	-rm -rf mcp
	-rm -rf output
	-rm -rf ccp_output.error   ccp_output_scm.xml  ccp_output.xml ccp_output.pclint  ccp_output.txt
endef
	

define mcp_ccpc
	ccp $(mcp_SOURCES) --formatter vim
endef
	

define mcp_cov
	
endef
	



#---------------------end build target : mcp------------------

define _output
	$(mcp_output)
endef
	

define _clean
	$(mcp_clean)
endef
	

ccpc : 
	$(mcp_ccpc)

cov : 
	cov01 -1
	make clean
	make 
	cov01 -0



output : mcp 
	$(_output)
	rm -rf $(MAKDEP)

$(MAKDEP) : $(wildcard comake_autogen.cpp main.cpp mcp.idl*.cpp chess_hall_props.idl*.cpp mcpsvr.cpp)
	-$(CC) -MG -MM $(CPPFLAGS) $(INCPATH) $(DEP_INCPATH) $^ > $@

clean:
	$(_clean)
	rm -rf $(MAKDEP)


